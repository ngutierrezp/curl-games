# Nginx config for serving the Bash Snake game script
# Place this inside your server block or include as a separate file

# HTTPS server: redirect only to GitHub
server {
    listen 443 ssl;
    server_name games.ngutierrezp.cl;

    ssl_certificate /etc/letsencrypt/live/games.ngutierrezp.cl/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/games.ngutierrezp.cl/privkey.pem; # managed by Certbot
    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot

    # Redirect / to the main GitHub repo
    location = / {
        return 301 https://github.com/ngutierrezp/curl-games;
    }

    # Redirect /snake (and similar) to the corresponding GitHub folder
    location ~ ^/([a-zA-Z0-9_-]+)$ {
        return 301 https://github.com/ngutierrezp/curl-games/tree/main/$1;
    }
}

# HTTP server: only serve for the games
server {
    listen 80;
    server_name games.ngutierrezp.cl;

    # Serve the snake.sh script at /snake
    location = /snake {
        default_type text/x-shellscript;
        alias /home/ubuntu/curl-games/snake/snake.sh;
        add_header Content-Disposition "inline; filename=snake.sh";
        # add_header Access-Control-Allow-Origin *;
    }

    # Optionally serve the raw script at /snake.sh
    location = /snake.sh {
        default_type text/x-shellscript;
        alias /home/ubuntu/curl-games/snake/snake.sh;
        add_header Content-Disposition "attachment; filename=snake.sh";
    }

    # ...add more locations for other games as needed...

    # Redirect / to GitHub
    location = / {
        return 301 https://github.com/ngutierrezp/curl-games;
    }
}
